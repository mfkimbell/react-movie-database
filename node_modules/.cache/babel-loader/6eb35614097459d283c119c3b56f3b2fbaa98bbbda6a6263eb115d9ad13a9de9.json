{"ast":null,"code":"import React, { useEffect, useLayoutEffect, forwardRef, useState, useRef, useImperativeHandle } from 'react';\nimport ReactDOM from 'react-dom';\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar useOnEscape = function useOnEscape(handler, active) {\n  if (active === void 0) {\n    active = true;\n  }\n  useEffect(function () {\n    if (!active) return;\n    var listener = function listener(event) {\n      // check if key is an Escape\n      if (event.key === 'Escape') handler(event);\n    };\n    document.addEventListener('keyup', listener);\n    return function () {\n      if (!active) return;\n      document.removeEventListener('keyup', listener);\n    };\n  }, [handler, active]);\n};\nvar useRepositionOnResize = function useRepositionOnResize(handler, active) {\n  if (active === void 0) {\n    active = true;\n  }\n  useEffect(function () {\n    if (!active) return;\n    var listener = function listener() {\n      handler();\n    };\n    window.addEventListener('resize', listener);\n    return function () {\n      if (!active) return;\n      window.removeEventListener('resize', listener);\n    };\n  }, [handler, active]);\n};\nvar useOnClickOutside = function useOnClickOutside(ref, handler, active) {\n  if (active === void 0) {\n    active = true;\n  }\n  useEffect(function () {\n    if (!active) return;\n    var listener = function listener(event) {\n      // Do nothing if clicking ref's element or descendent elements\n      var refs = Array.isArray(ref) ? ref : [ref];\n      var contains = false;\n      refs.forEach(function (r) {\n        if (!r.current || r.current.contains(event.target)) {\n          contains = true;\n          return;\n        }\n      });\n      event.stopPropagation();\n      if (!contains) handler(event);\n    };\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n    return function () {\n      if (!active) return;\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n  }, [ref, handler, active]);\n}; // Make sure that user is not able TAB out of the Modal content on Open\n\nvar useTabbing = function useTabbing(contentRef, active) {\n  if (active === void 0) {\n    active = true;\n  }\n  useEffect(function () {\n    if (!active) return;\n    var listener = function listener(event) {\n      // check if key is an Tab\n      if (event.keyCode === 9) {\n        var _contentRef$current;\n        var els = contentRef === null || contentRef === void 0 ? void 0 : (_contentRef$current = contentRef.current) === null || _contentRef$current === void 0 ? void 0 : _contentRef$current.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex=\"0\"]');\n        var focusableEls = Array.prototype.slice.call(els);\n        if (focusableEls.length === 1) {\n          event.preventDefault();\n          return;\n        }\n        var firstFocusableEl = focusableEls[0];\n        var lastFocusableEl = focusableEls[focusableEls.length - 1];\n        if (event.shiftKey && document.activeElement === firstFocusableEl) {\n          event.preventDefault();\n          lastFocusableEl.focus();\n        } else if (document.activeElement === lastFocusableEl) {\n          event.preventDefault();\n          firstFocusableEl.focus();\n        }\n      }\n    };\n    document.addEventListener('keydown', listener);\n    return function () {\n      if (!active) return;\n      document.removeEventListener('keydown', listener);\n    };\n  }, [contentRef, active]);\n};\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\nvar Style = {\n  popupContent: {\n    tooltip: {\n      position: 'absolute',\n      zIndex: 999\n    },\n    modal: {\n      position: 'relative',\n      margin: 'auto'\n    }\n  },\n  popupArrow: {\n    height: '8px',\n    width: '16px',\n    position: 'absolute',\n    background: 'transparent',\n    color: '#FFF',\n    zIndex: -1\n  },\n  overlay: {\n    tooltip: {\n      position: 'fixed',\n      top: '0',\n      bottom: '0',\n      left: '0',\n      right: '0',\n      zIndex: 999\n    },\n    modal: {\n      position: 'fixed',\n      top: '0',\n      bottom: '0',\n      left: '0',\n      right: '0',\n      display: 'flex',\n      zIndex: 999\n    }\n  }\n};\nvar POSITION_TYPES = ['top left', 'top center', 'top right', 'right top', 'right center', 'right bottom', 'bottom left', 'bottom center', 'bottom right', 'left top', 'left center', 'left bottom'];\nvar getCoordinatesForPosition = function getCoordinatesForPosition(triggerBounding, ContentBounding, position,\n//PopupPosition | PopupPosition[],\narrow, _ref) {\n  var offsetX = _ref.offsetX,\n    offsetY = _ref.offsetY;\n  var margin = arrow ? 8 : 0;\n  var args = position.split(' '); // the step N 1 : center the popup content => ok\n\n  var CenterTop = triggerBounding.top + triggerBounding.height / 2;\n  var CenterLeft = triggerBounding.left + triggerBounding.width / 2;\n  var height = ContentBounding.height,\n    width = ContentBounding.width;\n  var top = CenterTop - height / 2;\n  var left = CenterLeft - width / 2;\n  var transform = '';\n  var arrowTop = '0%';\n  var arrowLeft = '0%'; // the  step N 2 : => ok\n\n  switch (args[0]) {\n    case 'top':\n      top -= height / 2 + triggerBounding.height / 2 + margin;\n      transform = \"rotate(180deg)  translateX(50%)\";\n      arrowTop = '100%';\n      arrowLeft = '50%';\n      break;\n    case 'bottom':\n      top += height / 2 + triggerBounding.height / 2 + margin;\n      transform = \"rotate(0deg) translateY(-100%) translateX(-50%)\";\n      arrowLeft = '50%';\n      break;\n    case 'left':\n      left -= width / 2 + triggerBounding.width / 2 + margin;\n      transform = \" rotate(90deg)  translateY(50%) translateX(-25%)\";\n      arrowLeft = '100%';\n      arrowTop = '50%';\n      break;\n    case 'right':\n      left += width / 2 + triggerBounding.width / 2 + margin;\n      transform = \"rotate(-90deg)  translateY(-150%) translateX(25%)\";\n      arrowTop = '50%';\n      break;\n  }\n  switch (args[1]) {\n    case 'top':\n      top = triggerBounding.top;\n      arrowTop = triggerBounding.height / 2 + \"px\";\n      break;\n    case 'bottom':\n      top = triggerBounding.top - height + triggerBounding.height;\n      arrowTop = height - triggerBounding.height / 2 + \"px\";\n      break;\n    case 'left':\n      left = triggerBounding.left;\n      arrowLeft = triggerBounding.width / 2 + \"px\";\n      break;\n    case 'right':\n      left = triggerBounding.left - width + triggerBounding.width;\n      arrowLeft = width - triggerBounding.width / 2 + \"px\";\n      break;\n  }\n  top = args[0] === 'top' ? top - offsetY : top + offsetY;\n  left = args[0] === 'left' ? left - offsetX : left + offsetX;\n  return {\n    top: top,\n    left: left,\n    transform: transform,\n    arrowLeft: arrowLeft,\n    arrowTop: arrowTop\n  };\n};\nvar getTooltipBoundary = function getTooltipBoundary(keepTooltipInside) {\n  // add viewport\n  var boundingBox = {\n    top: 0,\n    left: 0,\n    /* eslint-disable-next-line no-undef */\n    width: window.innerWidth,\n    /* eslint-disable-next-line no-undef */\n    height: window.innerHeight\n  };\n  if (typeof keepTooltipInside === 'string') {\n    /* eslint-disable-next-line no-undef */\n    var selector = document.querySelector(keepTooltipInside);\n    if (process.env.NODE_ENV !== 'production') {\n      if (selector === null) throw new Error(keepTooltipInside + \" selector does not exist : keepTooltipInside must be a valid html selector 'class' or 'Id'  or a boolean value\");\n    }\n    if (selector !== null) boundingBox = selector.getBoundingClientRect();\n  }\n  return boundingBox;\n};\nvar calculatePosition = function calculatePosition(triggerBounding, ContentBounding, position, arrow, _ref2, keepTooltipInside) {\n  var offsetX = _ref2.offsetX,\n    offsetY = _ref2.offsetY;\n  var bestCoords = {\n    arrowLeft: '0%',\n    arrowTop: '0%',\n    left: 0,\n    top: 0,\n    transform: 'rotate(135deg)'\n  };\n  var i = 0;\n  var wrapperBox = getTooltipBoundary(keepTooltipInside);\n  var positions = Array.isArray(position) ? position : [position]; // keepTooltipInside would be activated if the  keepTooltipInside exist or the position is Array\n\n  if (keepTooltipInside || Array.isArray(position)) positions = [].concat(positions, POSITION_TYPES); // add viewPort for WarpperBox\n  // wrapperBox.top = wrapperBox.top + window.scrollY;\n  // wrapperBox.left = wrapperBox.left + window.scrollX;\n\n  while (i < positions.length) {\n    bestCoords = getCoordinatesForPosition(triggerBounding, ContentBounding, positions[i], arrow, {\n      offsetX: offsetX,\n      offsetY: offsetY\n    });\n    var contentBox = {\n      top: bestCoords.top,\n      left: bestCoords.left,\n      width: ContentBounding.width,\n      height: ContentBounding.height\n    };\n    if (contentBox.top <= wrapperBox.top || contentBox.left <= wrapperBox.left || contentBox.top + contentBox.height >= wrapperBox.top + wrapperBox.height || contentBox.left + contentBox.width >= wrapperBox.left + wrapperBox.width) {\n      i++;\n    } else {\n      break;\n    }\n  }\n  return bestCoords;\n};\nvar popupIdCounter = 0;\nvar getRootPopup = function getRootPopup() {\n  var PopupRoot = document.getElementById('popup-root');\n  if (PopupRoot === null) {\n    PopupRoot = document.createElement('div');\n    PopupRoot.setAttribute('id', 'popup-root');\n    document.body.appendChild(PopupRoot);\n  }\n  return PopupRoot;\n};\nvar Popup = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var _ref$trigger = _ref.trigger,\n    trigger = _ref$trigger === void 0 ? null : _ref$trigger,\n    _ref$onOpen = _ref.onOpen,\n    onOpen = _ref$onOpen === void 0 ? function () {} : _ref$onOpen,\n    _ref$onClose = _ref.onClose,\n    onClose = _ref$onClose === void 0 ? function () {} : _ref$onClose,\n    _ref$defaultOpen = _ref.defaultOpen,\n    defaultOpen = _ref$defaultOpen === void 0 ? false : _ref$defaultOpen,\n    _ref$open = _ref.open,\n    open = _ref$open === void 0 ? undefined : _ref$open,\n    _ref$disabled = _ref.disabled,\n    disabled = _ref$disabled === void 0 ? false : _ref$disabled,\n    _ref$nested = _ref.nested,\n    nested = _ref$nested === void 0 ? false : _ref$nested,\n    _ref$closeOnDocumentC = _ref.closeOnDocumentClick,\n    closeOnDocumentClick = _ref$closeOnDocumentC === void 0 ? true : _ref$closeOnDocumentC,\n    _ref$repositionOnResi = _ref.repositionOnResize,\n    repositionOnResize = _ref$repositionOnResi === void 0 ? true : _ref$repositionOnResi,\n    _ref$closeOnEscape = _ref.closeOnEscape,\n    closeOnEscape = _ref$closeOnEscape === void 0 ? true : _ref$closeOnEscape,\n    _ref$on = _ref.on,\n    on = _ref$on === void 0 ? ['click'] : _ref$on,\n    _ref$contentStyle = _ref.contentStyle,\n    contentStyle = _ref$contentStyle === void 0 ? {} : _ref$contentStyle,\n    _ref$arrowStyle = _ref.arrowStyle,\n    arrowStyle = _ref$arrowStyle === void 0 ? {} : _ref$arrowStyle,\n    _ref$overlayStyle = _ref.overlayStyle,\n    overlayStyle = _ref$overlayStyle === void 0 ? {} : _ref$overlayStyle,\n    _ref$className = _ref.className,\n    className = _ref$className === void 0 ? '' : _ref$className,\n    _ref$position = _ref.position,\n    position = _ref$position === void 0 ? 'bottom center' : _ref$position,\n    _ref$modal = _ref.modal,\n    modal = _ref$modal === void 0 ? false : _ref$modal,\n    _ref$lockScroll = _ref.lockScroll,\n    lockScroll = _ref$lockScroll === void 0 ? false : _ref$lockScroll,\n    _ref$arrow = _ref.arrow,\n    arrow = _ref$arrow === void 0 ? true : _ref$arrow,\n    _ref$offsetX = _ref.offsetX,\n    offsetX = _ref$offsetX === void 0 ? 0 : _ref$offsetX,\n    _ref$offsetY = _ref.offsetY,\n    offsetY = _ref$offsetY === void 0 ? 0 : _ref$offsetY,\n    _ref$mouseEnterDelay = _ref.mouseEnterDelay,\n    mouseEnterDelay = _ref$mouseEnterDelay === void 0 ? 100 : _ref$mouseEnterDelay,\n    _ref$mouseLeaveDelay = _ref.mouseLeaveDelay,\n    mouseLeaveDelay = _ref$mouseLeaveDelay === void 0 ? 100 : _ref$mouseLeaveDelay,\n    _ref$keepTooltipInsid = _ref.keepTooltipInside,\n    keepTooltipInside = _ref$keepTooltipInsid === void 0 ? false : _ref$keepTooltipInsid,\n    children = _ref.children;\n  var _useState = useState(open || defaultOpen),\n    isOpen = _useState[0],\n    setIsOpen = _useState[1];\n  var triggerRef = useRef(null);\n  var contentRef = useRef(null);\n  var arrowRef = useRef(null);\n  var focusedElBeforeOpen = useRef(null);\n  var popupId = useRef(\"popup-\" + ++popupIdCounter);\n  var isModal = modal ? true : !trigger;\n  var timeOut = useRef(0);\n  useIsomorphicLayoutEffect(function () {\n    if (isOpen) {\n      focusedElBeforeOpen.current = document.activeElement;\n      setPosition();\n      focusContentOnOpen(); // for accessibility\n\n      lockScrolll();\n    } else {\n      resetScroll();\n    }\n    return function () {\n      clearTimeout(timeOut.current);\n    };\n  }, [isOpen]); // for uncontrolled popup we need to sync isOpen with open prop\n\n  useEffect(function () {\n    if (typeof open === 'boolean') {\n      if (open) openPopup();else closePopup();\n    }\n  }, [open, disabled]);\n  var openPopup = function openPopup(event) {\n    if (isOpen || disabled) return;\n    setIsOpen(true);\n    setTimeout(function () {\n      return onOpen(event);\n    }, 0);\n  };\n  var closePopup = function closePopup(event) {\n    var _focusedElBeforeOpen$;\n    if (!isOpen || disabled) return;\n    setIsOpen(false);\n    if (isModal) (_focusedElBeforeOpen$ = focusedElBeforeOpen.current) === null || _focusedElBeforeOpen$ === void 0 ? void 0 : _focusedElBeforeOpen$.focus();\n    setTimeout(function () {\n      return onClose(event);\n    }, 0);\n  };\n  var togglePopup = function togglePopup(event) {\n    event === null || event === void 0 ? void 0 : event.stopPropagation();\n    if (!isOpen) openPopup(event);else closePopup(event);\n  };\n  var onMouseEnter = function onMouseEnter(event) {\n    clearTimeout(timeOut.current);\n    timeOut.current = setTimeout(function () {\n      return openPopup(event);\n    }, mouseEnterDelay);\n  };\n  var onContextMenu = function onContextMenu(event) {\n    event === null || event === void 0 ? void 0 : event.preventDefault();\n    togglePopup();\n  };\n  var onMouseLeave = function onMouseLeave(event) {\n    clearTimeout(timeOut.current);\n    timeOut.current = setTimeout(function () {\n      return closePopup(event);\n    }, mouseLeaveDelay);\n  };\n  var lockScrolll = function lockScrolll() {\n    if (isModal && lockScroll) document.getElementsByTagName('body')[0].style.overflow = 'hidden'; // migrate to document.body\n  };\n\n  var resetScroll = function resetScroll() {\n    if (isModal && lockScroll) document.getElementsByTagName('body')[0].style.overflow = 'auto';\n  };\n  var focusContentOnOpen = function focusContentOnOpen() {\n    var _contentRef$current;\n    var focusableEls = contentRef === null || contentRef === void 0 ? void 0 : (_contentRef$current = contentRef.current) === null || _contentRef$current === void 0 ? void 0 : _contentRef$current.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex=\"0\"]');\n    var firstEl = Array.prototype.slice.call(focusableEls)[0];\n    firstEl === null || firstEl === void 0 ? void 0 : firstEl.focus();\n  };\n  useImperativeHandle(ref, function () {\n    return {\n      open: function open() {\n        openPopup();\n      },\n      close: function close() {\n        closePopup();\n      },\n      toggle: function toggle() {\n        togglePopup();\n      }\n    };\n  }); // set Position\n\n  var setPosition = function setPosition() {\n    if (isModal || !isOpen) return;\n    if (!(triggerRef === null || triggerRef === void 0 ? void 0 : triggerRef.current) || !(triggerRef === null || triggerRef === void 0 ? void 0 : triggerRef.current) || !(contentRef === null || contentRef === void 0 ? void 0 : contentRef.current)) return; /// show error as one of ref is undefined\n\n    var trigger = triggerRef.current.getBoundingClientRect();\n    var content = contentRef.current.getBoundingClientRect();\n    var cords = calculatePosition(trigger, content, position, arrow, {\n      offsetX: offsetX,\n      offsetY: offsetY\n    }, keepTooltipInside);\n    contentRef.current.style.top = cords.top + window.scrollY + \"px\";\n    contentRef.current.style.left = cords.left + window.scrollX + \"px\";\n    if (arrow && !!arrowRef.current) {\n      var _arrowStyle$top, _arrowStyle$left;\n      arrowRef.current.style.transform = cords.transform;\n      arrowRef.current.style.setProperty('-ms-transform', cords.transform);\n      arrowRef.current.style.setProperty('-webkit-transform', cords.transform);\n      arrowRef.current.style.top = ((_arrowStyle$top = arrowStyle.top) === null || _arrowStyle$top === void 0 ? void 0 : _arrowStyle$top.toString()) || cords.arrowTop;\n      arrowRef.current.style.left = ((_arrowStyle$left = arrowStyle.left) === null || _arrowStyle$left === void 0 ? void 0 : _arrowStyle$left.toString()) || cords.arrowLeft;\n    }\n  }; // hooks\n\n  useOnEscape(closePopup, closeOnEscape); // can be optimized if we disabled for hover\n\n  useTabbing(contentRef, isOpen && isModal);\n  useRepositionOnResize(setPosition, repositionOnResize);\n  useOnClickOutside(!!trigger ? [contentRef, triggerRef] : [contentRef], closePopup, closeOnDocumentClick && !nested); // we need to add a ne\n  // render the trigger element and add events\n\n  var renderTrigger = function renderTrigger() {\n    var triggerProps = {\n      key: 'T',\n      ref: triggerRef,\n      'aria-describedby': popupId.current\n    };\n    var onAsArray = Array.isArray(on) ? on : [on];\n    for (var i = 0, len = onAsArray.length; i < len; i++) {\n      switch (onAsArray[i]) {\n        case 'click':\n          triggerProps.onClick = togglePopup;\n          break;\n        case 'right-click':\n          triggerProps.onContextMenu = onContextMenu;\n          break;\n        case 'hover':\n          triggerProps.onMouseEnter = onMouseEnter;\n          triggerProps.onMouseLeave = onMouseLeave;\n          break;\n        case 'focus':\n          triggerProps.onFocus = onMouseEnter;\n          triggerProps.onBlur = onMouseLeave;\n          break;\n      }\n    }\n    if (typeof trigger === 'function') {\n      var comp = trigger(isOpen);\n      return !!trigger && React.cloneElement(comp, triggerProps);\n    }\n    return !!trigger && React.cloneElement(trigger, triggerProps);\n  };\n  var addWarperAction = function addWarperAction() {\n    var popupContentStyle = isModal ? Style.popupContent.modal : Style.popupContent.tooltip;\n    var childrenElementProps = {\n      className: \"popup-content \" + (className !== '' ? className.split(' ').map(function (c) {\n        return c + \"-content\";\n      }).join(' ') : ''),\n      style: _extends({}, popupContentStyle, contentStyle, {\n        pointerEvents: 'auto'\n      }),\n      ref: contentRef,\n      onClick: function onClick(e) {\n        e.stopPropagation();\n      }\n    };\n    if (!modal && on.indexOf('hover') >= 0) {\n      childrenElementProps.onMouseEnter = onMouseEnter;\n      childrenElementProps.onMouseLeave = onMouseLeave;\n    }\n    return childrenElementProps;\n  };\n  var renderContent = function renderContent() {\n    return React.createElement(\"div\", Object.assign({}, addWarperAction(), {\n      key: \"C\",\n      role: isModal ? 'dialog' : 'tooltip',\n      id: popupId.current\n    }), arrow && !isModal && React.createElement(\"div\", {\n      ref: arrowRef,\n      style: Style.popupArrow\n    }, React.createElement(\"svg\", {\n      \"data-testid\": \"arrow\",\n      className: \"popup-arrow \" + (className !== '' ? className.split(' ').map(function (c) {\n        return c + \"-arrow\";\n      }).join(' ') : ''),\n      viewBox: \"0 0 32 16\",\n      style: _extends({\n        position: 'absolute'\n      }, arrowStyle)\n    }, React.createElement(\"path\", {\n      d: \"M16 0l16 16H0z\",\n      fill: \"currentcolor\"\n    }))), children && typeof children === 'function' ? children(closePopup, isOpen) : children);\n  };\n  var overlay = !(on.indexOf('hover') >= 0);\n  var ovStyle = isModal ? Style.overlay.modal : Style.overlay.tooltip;\n  var content = [overlay && React.createElement(\"div\", {\n    key: \"O\",\n    \"data-testid\": \"overlay\",\n    \"data-popup\": isModal ? 'modal' : 'tooltip',\n    className: \"popup-overlay \" + (className !== '' ? className.split(' ').map(function (c) {\n      return c + \"-overlay\";\n    }).join(' ') : ''),\n    style: _extends({}, ovStyle, overlayStyle, {\n      pointerEvents: closeOnDocumentClick && nested || isModal ? 'auto' : 'none'\n    }),\n    onClick: closeOnDocumentClick && nested ? closePopup : undefined,\n    tabIndex: -1\n  }, isModal && renderContent()), !isModal && renderContent()];\n  return React.createElement(React.Fragment, null, renderTrigger(), isOpen && ReactDOM.createPortal(content, getRootPopup()));\n});\nexport default Popup;\nexport { Popup };","map":{"version":3,"names":["useOnEscape","handler","active","useEffect","listener","event","key","document","addEventListener","removeEventListener","useRepositionOnResize","window","useOnClickOutside","ref","refs","Array","isArray","contains","forEach","r","current","target","stopPropagation","useTabbing","contentRef","keyCode","_contentRef$current","els","querySelectorAll","focusableEls","prototype","slice","call","length","preventDefault","firstFocusableEl","lastFocusableEl","shiftKey","activeElement","focus","useIsomorphicLayoutEffect","useLayoutEffect","Style","popupContent","tooltip","position","zIndex","modal","margin","popupArrow","height","width","background","color","overlay","top","bottom","left","right","display","POSITION_TYPES","getCoordinatesForPosition","triggerBounding","ContentBounding","arrow","_ref","offsetX","offsetY","args","split","CenterTop","CenterLeft","transform","arrowTop","arrowLeft","getTooltipBoundary","keepTooltipInside","boundingBox","innerWidth","innerHeight","selector","querySelector","process","env","NODE_ENV","Error","getBoundingClientRect","calculatePosition","_ref2","bestCoords","i","wrapperBox","positions","concat","contentBox","popupIdCounter","getRootPopup","PopupRoot","getElementById","createElement","setAttribute","body","appendChild","Popup","forwardRef","trigger","_ref$trigger","onOpen","_ref$onOpen","onClose","_ref$onClose","defaultOpen","_ref$defaultOpen","open","_ref$open","undefined","disabled","_ref$disabled","nested","_ref$nested","closeOnDocumentClick","_ref$closeOnDocumentC","repositionOnResize","_ref$repositionOnResi","closeOnEscape","_ref$closeOnEscape","on","_ref$on","contentStyle","_ref$contentStyle","arrowStyle","_ref$arrowStyle","overlayStyle","_ref$overlayStyle","className","_ref$className","_ref$position","_ref$modal","lockScroll","_ref$lockScroll","_ref$arrow","_ref$offsetX","_ref$offsetY","mouseEnterDelay","_ref$mouseEnterDelay","mouseLeaveDelay","_ref$mouseLeaveDelay","_ref$keepTooltipInsid","children","useState","isOpen","_useState","setIsOpen","triggerRef","useRef","arrowRef","focusedElBeforeOpen","popupId","isModal","timeOut","setPosition","focusContentOnOpen","lockScrolll","resetScroll","clearTimeout","openPopup","closePopup","setTimeout","_focusedElBeforeOpen$","togglePopup","onMouseEnter","onContextMenu","onMouseLeave","getElementsByTagName","style","overflow","firstEl","useImperativeHandle","close","toggle","content","cords","scrollY","scrollX","_arrowStyle$top","_arrowStyle$left","setProperty","toString","renderTrigger","triggerProps","onAsArray","len","onClick","onFocus","onBlur","comp","React","cloneElement","addWarperAction","popupContentStyle","childrenElementProps","map","c","join","_extends","pointerEvents","e","indexOf","renderContent","Object","assign","role","id","viewBox","d","fill","ovStyle","tabIndex","Fragment","ReactDOM","createPortal"],"sources":["C:\\Users\\mfkim\\source\\repos\\react-movie-database\\node_modules\\reactjs-popup\\src\\hooks.tsx","C:\\Users\\mfkim\\source\\repos\\react-movie-database\\node_modules\\reactjs-popup\\src\\styles.ts","C:\\Users\\mfkim\\source\\repos\\react-movie-database\\node_modules\\reactjs-popup\\src\\Utils.ts","C:\\Users\\mfkim\\source\\repos\\react-movie-database\\node_modules\\reactjs-popup\\src\\index.tsx"],"sourcesContent":["import { useEffect, RefObject, useLayoutEffect } from 'react';\n\nexport const useOnEscape = (\n  handler: (event: KeyboardEvent) => void,\n  active = true\n) => {\n  useEffect(() => {\n    if (!active) return;\n    const listener = (event: KeyboardEvent) => {\n      // check if key is an Escape\n      if (event.key === 'Escape') handler(event);\n    };\n    document.addEventListener('keyup', listener);\n\n    return () => {\n      if (!active) return;\n      document.removeEventListener('keyup', listener);\n    };\n  }, [handler, active]);\n};\n\nexport const useRepositionOnResize = (handler: () => void, active = true) => {\n  useEffect(() => {\n    if (!active) return;\n    const listener = () => {\n      handler();\n    };\n\n    window.addEventListener('resize', listener);\n\n    return () => {\n      if (!active) return;\n      window.removeEventListener('resize', listener);\n    };\n  }, [handler, active]);\n};\n\nexport const useOnClickOutside = (\n  ref: RefObject<HTMLElement> | RefObject<HTMLElement>[],\n  handler: (event: TouchEvent | MouseEvent) => void,\n  active = true\n) => {\n  useEffect(() => {\n    if (!active) return;\n    const listener = (event: TouchEvent | MouseEvent) => {\n      // Do nothing if clicking ref's element or descendent elements\n      const refs = Array.isArray(ref) ? ref : [ref];\n\n      let contains = false;\n      refs.forEach(r => {\n        if (!r.current || r.current.contains(event.target as Node)) {\n          contains = true;\n          return;\n        }\n      });\n      event.stopPropagation();\n      if (!contains) handler(event);\n    };\n\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n\n    return () => {\n      if (!active) return;\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n  }, [ref, handler, active]);\n};\n\n// Make sure that user is not able TAB out of the Modal content on Open\nexport const useTabbing = (\n  contentRef: RefObject<HTMLElement>,\n  active = true\n) => {\n  useEffect(() => {\n    if (!active) return;\n    const listener = (event: KeyboardEvent) => {\n      // check if key is an Tab\n      if (event.keyCode === 9) {\n        const els = contentRef?.current?.querySelectorAll(\n          'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex=\"0\"]'\n        );\n\n        const focusableEls = Array.prototype.slice.call(els);\n        if (focusableEls.length === 1) {\n          event.preventDefault();\n          return;\n        }\n\n        const firstFocusableEl = focusableEls[0];\n        const lastFocusableEl = focusableEls[focusableEls.length - 1];\n        if (event.shiftKey && document.activeElement === firstFocusableEl) {\n          event.preventDefault();\n          lastFocusableEl.focus();\n        } else if (document.activeElement === lastFocusableEl) {\n          event.preventDefault();\n          firstFocusableEl.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', listener);\n\n    return () => {\n      if (!active) return;\n      document.removeEventListener('keydown', listener);\n    };\n  }, [contentRef, active]);\n};\n\nexport const useIsomorphicLayoutEffect =\n  typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n","import React from 'react';\n\ntype PopupStyle = {\n  popupContent: {\n    tooltip: React.CSSProperties;\n    modal: React.CSSProperties;\n  };\n  popupArrow: React.CSSProperties;\n  overlay: {\n    tooltip: React.CSSProperties;\n    modal: React.CSSProperties;\n  };\n};\n\nconst Style: PopupStyle = {\n  popupContent: {\n    tooltip: {\n      position: 'absolute',\n      zIndex: 999,\n    },\n    modal: {\n      position: 'relative',\n      margin: 'auto',\n    },\n  },\n  popupArrow: {\n    height: '8px',\n    width: '16px',\n    position: 'absolute',\n    background: 'transparent',\n    color: '#FFF',\n    zIndex: -1,\n  },\n  overlay: {\n    tooltip: {\n      position: 'fixed',\n      top: '0',\n      bottom: '0',\n      left: '0',\n      right: '0',\n      zIndex: 999,\n    },\n    modal: {\n      position: 'fixed',\n      top: '0',\n      bottom: '0',\n      left: '0',\n      right: '0',\n      display: 'flex',\n      zIndex: 999,\n    },\n  },\n};\n\nexport default Style;\n","/* Algo to calculate position\n  1. center position for popup content : the center of the trigger will be the center of the content content\n      so the popup content position will be like this :\n      top => the y of the center for the trigger element : trigger.top + trigger.height/2\n      left => the x of the center for the trigger element : trigger.left + trigger.width/2\n\n  2. translate position according to the first  position attribute  passed  in the function argument\n      for example :\n        position = 'left top'\n        we need to handle the first argument in the position: 'left' => that's mean we need to translate the popup content according to the X axis by - content.width/2\n\n  3.translate position according to the first  position attribute  passed  in the function argument\n    for example :\n      position = 'left top'\n      the second argument 'top' => translate popup content by + content.height*4/5\n\n  4. check if calculated position is going out of bounds of wrapper box or not. If yes repeat 1-3 for next position enum. By default wrapper box is window element\n*/\nimport { PopupPosition } from './types';\n\nexport const POSITION_TYPES: PopupPosition[] = [\n  'top left',\n  'top center',\n  'top right',\n  'right top',\n  'right center',\n  'right bottom',\n  'bottom left',\n  'bottom center',\n  'bottom right',\n  'left top',\n  'left center',\n  'left bottom',\n  //'center center',\n];\n\ntype CordsType = {\n  top: number;\n  left: number;\n  transform: string;\n  arrowLeft: string;\n  arrowTop: string;\n};\n\nconst getCoordinatesForPosition = (\n  triggerBounding: DOMRect,\n  ContentBounding: DOMRect,\n  position: PopupPosition, //PopupPosition | PopupPosition[],\n  arrow: boolean,\n  { offsetX, offsetY }: { offsetX: number; offsetY: number }\n): CordsType => {\n  const margin = arrow ? 8 : 0;\n  const args = position.split(' ');\n  // the step N 1 : center the popup content => ok\n  const CenterTop = triggerBounding.top + triggerBounding.height / 2;\n  const CenterLeft = triggerBounding.left + triggerBounding.width / 2;\n  const { height, width } = ContentBounding;\n  let top = CenterTop - height / 2;\n  let left = CenterLeft - width / 2;\n  let transform = '';\n  let arrowTop = '0%';\n  let arrowLeft = '0%';\n  // the  step N 2 : => ok\n  switch (args[0]) {\n    case 'top':\n      top -= height / 2 + triggerBounding.height / 2 + margin;\n      transform = `rotate(180deg)  translateX(50%)`;\n      arrowTop = '100%';\n      arrowLeft = '50%';\n      break;\n    case 'bottom':\n      top += height / 2 + triggerBounding.height / 2 + margin;\n      transform = `rotate(0deg) translateY(-100%) translateX(-50%)`;\n      arrowLeft = '50%';\n      break;\n    case 'left':\n      left -= width / 2 + triggerBounding.width / 2 + margin;\n      transform = ` rotate(90deg)  translateY(50%) translateX(-25%)`;\n      arrowLeft = '100%';\n      arrowTop = '50%';\n      break;\n    case 'right':\n      left += width / 2 + triggerBounding.width / 2 + margin;\n      transform = `rotate(-90deg)  translateY(-150%) translateX(25%)`;\n      arrowTop = '50%';\n      break;\n    default:\n  }\n  switch (args[1]) {\n    case 'top':\n      top = triggerBounding.top;\n      arrowTop = `${triggerBounding.height / 2}px`;\n      break;\n    case 'bottom':\n      top = triggerBounding.top - height + triggerBounding.height;\n      arrowTop = `${height - triggerBounding.height / 2}px`;\n      break;\n    case 'left':\n      left = triggerBounding.left;\n      arrowLeft = `${triggerBounding.width / 2}px`;\n      break;\n    case 'right':\n      left = triggerBounding.left - width + triggerBounding.width;\n      arrowLeft = `${width - triggerBounding.width / 2}px`;\n      break;\n    default:\n  }\n\n  top = args[0] === 'top' ? top - offsetY : top + offsetY;\n  left = args[0] === 'left' ? left - offsetX : left + offsetX;\n\n  return { top, left, transform, arrowLeft, arrowTop };\n};\n\nexport const getTooltipBoundary = (keepTooltipInside: string | Boolean) => {\n  // add viewport\n  let boundingBox = {\n    top: 0,\n    left: 0,\n    /* eslint-disable-next-line no-undef */\n    width: window.innerWidth,\n    /* eslint-disable-next-line no-undef */\n    height: window.innerHeight,\n  };\n  if (typeof keepTooltipInside === 'string') {\n    /* eslint-disable-next-line no-undef */\n    const selector = document.querySelector(keepTooltipInside);\n    if (process.env.NODE_ENV !== 'production') {\n      if (selector === null)\n        throw new Error(\n          `${keepTooltipInside} selector does not exist : keepTooltipInside must be a valid html selector 'class' or 'Id'  or a boolean value`\n        );\n    }\n    if (selector !== null) boundingBox = selector.getBoundingClientRect();\n  }\n\n  return boundingBox;\n};\n\nconst calculatePosition = (\n  triggerBounding: DOMRect,\n  ContentBounding: DOMRect,\n  position: PopupPosition | PopupPosition[],\n  arrow: boolean,\n  { offsetX, offsetY }: { offsetX: number; offsetY: number },\n  keepTooltipInside: string | boolean\n): CordsType => {\n  let bestCoords: CordsType = {\n    arrowLeft: '0%',\n    arrowTop: '0%',\n    left: 0,\n    top: 0,\n    transform: 'rotate(135deg)',\n  };\n  let i = 0;\n  const wrapperBox = getTooltipBoundary(keepTooltipInside);\n  let positions = Array.isArray(position) ? position : [position];\n\n  // keepTooltipInside would be activated if the  keepTooltipInside exist or the position is Array\n  if (keepTooltipInside || Array.isArray(position))\n    positions = [...positions, ...POSITION_TYPES];\n\n  // add viewPort for WarpperBox\n  // wrapperBox.top = wrapperBox.top + window.scrollY;\n  // wrapperBox.left = wrapperBox.left + window.scrollX;\n\n  while (i < positions.length) {\n    bestCoords = getCoordinatesForPosition(\n      triggerBounding,\n      ContentBounding,\n      positions[i],\n      arrow,\n      { offsetX, offsetY }\n    );\n\n    const contentBox = {\n      top: bestCoords.top,\n      left: bestCoords.left,\n      width: ContentBounding.width,\n      height: ContentBounding.height,\n    };\n\n    if (\n      contentBox.top <= wrapperBox.top ||\n      contentBox.left <= wrapperBox.left ||\n      contentBox.top + contentBox.height >=\n        wrapperBox.top + wrapperBox.height ||\n      contentBox.left + contentBox.width >= wrapperBox.left + wrapperBox.width\n    ) {\n      i++;\n    } else {\n      break;\n    }\n  }\n\n  return bestCoords;\n};\n\nexport default calculatePosition;\n","import React, {\n  useState,\n  useRef,\n  useEffect,\n  forwardRef,\n  useImperativeHandle,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport { PopupProps, PopupActions } from './types';\nimport {\n  useOnEscape,\n  useRepositionOnResize,\n  useOnClickOutside,\n  useTabbing,\n  useIsomorphicLayoutEffect,\n} from './hooks';\n\nimport './index.css';\n\nimport styles from './styles';\nimport calculatePosition from './Utils';\n\nlet popupIdCounter = 0;\n\nconst getRootPopup = () => {\n  let PopupRoot = document.getElementById('popup-root');\n\n  if (PopupRoot === null) {\n    PopupRoot = document.createElement('div');\n    PopupRoot.setAttribute('id', 'popup-root');\n    document.body.appendChild(PopupRoot);\n  }\n\n  return PopupRoot;\n};\n\nexport const Popup = forwardRef<PopupActions, PopupProps>(\n  (\n    {\n      trigger = null,\n      onOpen = () => {},\n      onClose = () => {},\n      defaultOpen = false,\n      open = undefined,\n      disabled = false,\n      nested = false,\n      closeOnDocumentClick = true,\n      repositionOnResize = true,\n      closeOnEscape = true,\n      on = ['click'],\n      contentStyle = {},\n      arrowStyle = {},\n      overlayStyle = {},\n      className = '',\n      position = 'bottom center',\n      modal = false,\n      lockScroll = false,\n      arrow = true,\n      offsetX = 0,\n      offsetY = 0,\n      mouseEnterDelay = 100,\n      mouseLeaveDelay = 100,\n      keepTooltipInside = false,\n      children,\n    },\n    ref\n  ) => {\n    const [isOpen, setIsOpen] = useState<boolean>(open || defaultOpen);\n    const triggerRef = useRef<HTMLElement>(null);\n    const contentRef = useRef<HTMLElement>(null);\n    const arrowRef = useRef<HTMLDivElement>(null);\n    const focusedElBeforeOpen = useRef<Element | null>(null);\n    const popupId = useRef<string>(`popup-${++popupIdCounter}`);\n\n    const isModal = modal ? true : !trigger;\n    const timeOut = useRef<any>(0);\n\n    useIsomorphicLayoutEffect(() => {\n      if (isOpen) {\n        focusedElBeforeOpen.current = document.activeElement;\n        setPosition();\n        focusContentOnOpen(); // for accessibility\n        lockScrolll();\n      } else {\n        resetScroll();\n      }\n      return () => {\n        clearTimeout(timeOut.current);\n      };\n    }, [isOpen]);\n\n    // for uncontrolled popup we need to sync isOpen with open prop\n    useEffect(() => {\n      if (typeof open === 'boolean') {\n        if (open) openPopup();\n        else closePopup();\n      }\n    }, [open, disabled]);\n\n    const openPopup = (event?: React.SyntheticEvent) => {\n      if (isOpen || disabled) return;\n      setIsOpen(true);\n      setTimeout(() => onOpen(event), 0);\n    };\n\n    const closePopup = (\n      event?: React.SyntheticEvent | KeyboardEvent | TouchEvent | MouseEvent\n    ) => {\n      if (!isOpen || disabled) return;\n      setIsOpen(false);\n      if (isModal) (focusedElBeforeOpen.current as HTMLElement)?.focus();\n      setTimeout(() => onClose(event), 0);\n    };\n\n    const togglePopup = (event?: React.SyntheticEvent) => {\n      event?.stopPropagation();\n      if (!isOpen) openPopup(event);\n      else closePopup(event);\n    };\n\n    const onMouseEnter = (event?: React.SyntheticEvent) => {\n      clearTimeout(timeOut.current);\n      timeOut.current = setTimeout(() => openPopup(event), mouseEnterDelay);\n    };\n\n    const onContextMenu = (event?: React.SyntheticEvent) => {\n      event?.preventDefault();\n      togglePopup();\n    };\n\n    const onMouseLeave = (event?: React.SyntheticEvent) => {\n      clearTimeout(timeOut.current);\n      timeOut.current = setTimeout(() => closePopup(event), mouseLeaveDelay);\n    };\n\n    const lockScrolll = () => {\n      if (isModal && lockScroll)\n        document.getElementsByTagName('body')[0].style.overflow = 'hidden'; // migrate to document.body\n    };\n\n    const resetScroll = () => {\n      if (isModal && lockScroll)\n        document.getElementsByTagName('body')[0].style.overflow = 'auto';\n    };\n    const focusContentOnOpen = () => {\n      const focusableEls = contentRef?.current?.querySelectorAll(\n        'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex=\"0\"]'\n      );\n      const firstEl = Array.prototype.slice.call(focusableEls)[0];\n      firstEl?.focus();\n    };\n\n    useImperativeHandle(ref, () => ({\n      open: () => {\n        openPopup();\n      },\n      close: () => {\n        closePopup();\n      },\n      toggle: () => {\n        togglePopup();\n      },\n    }));\n\n    // set Position\n    const setPosition = () => {\n      if (isModal || !isOpen) return;\n      if (!triggerRef?.current || !triggerRef?.current || !contentRef?.current)\n        return; /// show error as one of ref is undefined\n      const trigger = triggerRef.current.getBoundingClientRect();\n      const content = contentRef.current.getBoundingClientRect();\n\n      const cords = calculatePosition(\n        trigger,\n        content,\n        position,\n        arrow,\n        {\n          offsetX,\n          offsetY,\n        },\n        keepTooltipInside\n      );\n      contentRef.current.style.top = `${cords.top + window.scrollY}px`;\n      contentRef.current.style.left = `${cords.left + window.scrollX}px`;\n      if (arrow && !!arrowRef.current) {\n        arrowRef.current.style.transform = cords.transform;\n        arrowRef.current.style.setProperty('-ms-transform', cords.transform);\n        arrowRef.current.style.setProperty(\n          '-webkit-transform',\n          cords.transform\n        );\n        arrowRef.current.style.top =\n          arrowStyle.top?.toString() || cords.arrowTop;\n        arrowRef.current.style.left =\n          arrowStyle.left?.toString() || cords.arrowLeft;\n      }\n    };\n    // hooks\n    useOnEscape(closePopup, closeOnEscape); // can be optimized if we disabled for hover\n    useTabbing(contentRef, isOpen && isModal);\n    useRepositionOnResize(setPosition, repositionOnResize);\n    useOnClickOutside(\n      !!trigger ? [contentRef, triggerRef] : [contentRef],\n      closePopup,\n      closeOnDocumentClick && !nested\n    ); // we need to add a ne\n    // render the trigger element and add events\n    const renderTrigger = () => {\n      const triggerProps: any = {\n        key: 'T',\n        ref: triggerRef,\n        'aria-describedby': popupId.current,\n      };\n      const onAsArray = Array.isArray(on) ? on : [on];\n      for (let i = 0, len = onAsArray.length; i < len; i++) {\n        switch (onAsArray[i]) {\n          case 'click':\n            triggerProps.onClick = togglePopup;\n            break;\n          case 'right-click':\n            triggerProps.onContextMenu = onContextMenu;\n            break;\n          case 'hover':\n            triggerProps.onMouseEnter = onMouseEnter;\n            triggerProps.onMouseLeave = onMouseLeave;\n            break;\n          case 'focus':\n            triggerProps.onFocus = onMouseEnter;\n            triggerProps.onBlur = onMouseLeave;\n            break;\n          default:\n        }\n      }\n\n      if (typeof trigger === 'function') {\n        const comp = trigger(isOpen);\n        return !!trigger && React.cloneElement(comp, triggerProps);\n      }\n\n      return !!trigger && React.cloneElement(trigger, triggerProps);\n    };\n\n    const addWarperAction = () => {\n      const popupContentStyle = isModal\n        ? styles.popupContent.modal\n        : styles.popupContent.tooltip;\n\n      const childrenElementProps: any = {\n        className: `popup-content ${\n          className !== ''\n            ? className\n                .split(' ')\n                .map(c => `${c}-content`)\n                .join(' ')\n            : ''\n        }`,\n        style: {\n          ...popupContentStyle,\n          ...contentStyle,\n          pointerEvents: 'auto', //closeOnDocumentClick && nested ? 'auto' : 'none',\n        },\n        ref: contentRef,\n        onClick: (e: any) => {\n          e.stopPropagation();\n        },\n      };\n      if (!modal && on.indexOf('hover') >= 0) {\n        childrenElementProps.onMouseEnter = onMouseEnter;\n        childrenElementProps.onMouseLeave = onMouseLeave;\n      }\n      return childrenElementProps;\n    };\n\n    const renderContent = () => {\n      return (\n        <div\n          {...addWarperAction()}\n          key=\"C\"\n          role={isModal ? 'dialog' : 'tooltip'}\n          id={popupId.current}\n        >\n          {arrow && !isModal && (\n            <div ref={arrowRef} style={styles.popupArrow}>\n              <svg\n                data-testid=\"arrow\"\n                className={`popup-arrow ${\n                  className !== ''\n                    ? className\n                        .split(' ')\n                        .map(c => `${c}-arrow`)\n                        .join(' ')\n                    : ''\n                }`}\n                viewBox=\"0 0 32 16\"\n                style={{\n                  position: 'absolute',\n                  ...arrowStyle,\n                }}\n              >\n                <path d=\"M16 0l16 16H0z\" fill=\"currentcolor\" />\n              </svg>\n            </div>\n          )}\n          {children && typeof children === 'function'\n            ? children(closePopup, isOpen)\n            : children}\n        </div>\n      );\n    };\n\n    const overlay = !(on.indexOf('hover') >= 0);\n    const ovStyle = isModal ? styles.overlay.modal : styles.overlay.tooltip;\n\n    const content = [\n      overlay && (\n        <div\n          key=\"O\"\n          data-testid=\"overlay\"\n          data-popup={isModal ? 'modal' : 'tooltip'}\n          className={`popup-overlay ${\n            className !== ''\n              ? className\n                  .split(' ')\n                  .map(c => `${c}-overlay`)\n                  .join(' ')\n              : ''\n          }`}\n          style={{\n            ...ovStyle,\n            ...overlayStyle,\n            pointerEvents:\n              (closeOnDocumentClick && nested) || isModal ? 'auto' : 'none',\n          }}\n          onClick={closeOnDocumentClick && nested ? closePopup : undefined}\n          tabIndex={-1}\n        >\n          {isModal && renderContent()}\n        </div>\n      ),\n\n      !isModal && renderContent(),\n    ];\n\n    return (\n      <>\n        {renderTrigger()}\n        {isOpen && ReactDOM.createPortal(content, getRootPopup())}\n      </>\n    );\n  }\n);\n\nexport default Popup;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}